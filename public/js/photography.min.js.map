{"version":3,"sources":["photography.js"],"names":["preload","url","cb","const","loader","Image","onload","src","loadThumbnail","img","getBoundingClientRect","top","window","innerHeight","urlThumb","getAttribute","style","backgroundImage","classList","remove","openViewer","clearTimeout","resetViewer","urlFull","LOADED_FULL","viewer","setTimeout","setAttribute","pos","width","height","left","clientHeight","add","closeViewer","LOADED_PREVIEW","document","querySelector","Array","prototype","slice","call","querySelectorAll","forEach","urlPreview","addEventListener","e","preventDefault","func","wait","immediate","timeout","context","this","args","arguments","callNow","apply","debounce","keyCode","contains"],"mappings":"CAAA,WAoDE,SAASA,EAAQC,EAAKC,GACpBC,IAAMC,EAAS,IAAIC,MACnBD,EAAOE,OAASJ,EAChBE,EAAOG,IAAMN,EAQf,SAASO,EAAcC,GACrB,GAAIA,EAAIC,wBAAwBC,IAAMC,OAAOC,YAAc,IAAK,CAC9DV,IAAMW,EAAWL,EAAIM,aAAa,cAClCf,EAAQc,EAAQ,WACdL,EAAIO,MAAMC,gBAAkB,OAAAH,EAAO,IACnCL,EAAIS,UAAUC,OAAO,6BAK3B,SAASC,EAAWX,GAClBY,aAAaC,GACbnB,IAAMW,EAAWL,EAAIM,aAAa,cAC5BQ,EAAUd,EAAIM,aAAa,aAE7BN,EAAIM,aAAa,eAAiBS,GACpCC,EAAOT,MAAMC,gBAAkB,OAAAH,EAAO,IAEtCd,EAAQuB,EAAO,WACbG,WAAU,WACRD,EAAOT,MAAMC,gBAAkB,OAAAM,EAAO,IACtCd,EAAIkB,aAAa,cAAeH,IAC/B,QAGLC,EAAOT,MAAMC,gBAAkB,OAAAM,EAAO,IAGxCpB,IAAMyB,EAAMnB,EAAIC,wBAChBe,EAAOT,MAAMa,MAAQD,EAAIC,MAAQ,KACjCJ,EAAOT,MAAMc,OAASF,EAAIE,OAAS,KACnCL,EAAOT,MAAML,IAAMiB,EAAIjB,IAAM,KAC7Bc,EAAOT,MAAMe,KAAOH,EAAIG,KAAO,KAC/BN,EAAOO,aACPP,EAAOP,UAAUe,IAAI,wBAGvB,SAASC,IACPT,EAAOP,UAAUe,IAAI,2BACrBR,EAAOP,UAAUC,OAAO,wBAExBG,EAAcI,WAAU,WACtBD,EAAOP,UAAUC,OAAO,2BACxBM,EAAOT,MAAMC,gBAAkB,GAC/BQ,EAAOT,MAAMa,MAAQ,GACrBJ,EAAOT,MAAMc,OAAS,GACtBL,EAAOT,MAAML,IAAM,GACnBc,EAAOT,MAAMe,KAAO,IACnB,KA9GL5B,IAMImB,EANEa,EAAmB,EAEnBX,EAAgB,EAEhBC,EAASW,SAASC,cAAc,mBACzBC,MAAMC,UAAUC,MAAMC,KAAKL,SAASM,iBAAiB,mBAG7DC,QAAO,SAAAlC,GACVN,IAAMyC,EAAanC,EAAIM,aAAa,gBAEpCN,EAAIS,UAAUe,IAAI,0BAClBjC,EAAQ4C,EAAU,WACZnC,EAAIM,aAAa,eAAiBoB,IACpC1B,EAAIO,MAAMC,gBAAkB,OAAA2B,EAAO,IACnCnC,EAAIkB,aAAa,cAAeQ,GAChC3B,EAAcC,MAIlBA,EAAIoC,iBAAiB,QAAO,SAAAC,GAC1B1B,EAAWX,GACXqC,EAAEC,qBAINtB,EAAOoB,iBAAiB,QAASX,GACjCtB,OAAOiC,iBAAiB,SASxB,SAAkBG,EAAMC,EAAMC,GAC5B,IAAIC,EACJ,OAAO,WACL,IAAIC,EAAUC,KAAMC,EAAOC,UAKvBC,EAAUN,IAAcC,EAC5B9B,aAAa8B,GACbA,EAAUzB,WANE,WACVyB,EAAU,KACLD,GAASF,EAAES,MAAKL,EAAaE,IAIRL,GACxBO,GAAOR,EAAES,MAAKL,EAAaE,IApBDI,CA8BlC,WACepB,MAAMC,UAAUC,MAAMC,KAAKL,SAASM,iBAAiB,iBAAAP,EAAiB,OAC9EQ,QAAQnC,IAhC4C,KAE3D4B,SAASS,iBAAiB,QAAO,SAAAC,GACb,KAAdA,EAAEa,SAAkBlC,EAAOP,UAAU0C,SAAS,0BAChD1B,IACAY,EAAEC,oBAjCR","file":"photography.min.js","sourcesContent":["(() => {\r\n  const LOADED_PREVIEW = 1;\r\n  const LOADED_THUMB = 2;\r\n  const LOADED_FULL = 3;\r\n\r\n  const viewer = document.querySelector('.Gallery-viewer');\r\n  const imgs = Array.prototype.slice.call(document.querySelectorAll('[data-preview]'));\r\n  let resetViewer;\r\n  \r\n  imgs.forEach((img) => {\r\n    const urlPreview = img.getAttribute('data-preview');\r\n  \r\n    img.classList.add('Gallery-image--preview');\r\n    preload(urlPreview, () => {\r\n      if (img.getAttribute('data-loaded') < LOADED_PREVIEW) {\r\n        img.style.backgroundImage = `url(${urlPreview})`;\r\n        img.setAttribute('data-loaded', LOADED_PREVIEW);\r\n        loadThumbnail(img);\r\n      }\r\n    });\r\n  \r\n    img.addEventListener('click', (e) => {\r\n      openViewer(img);\r\n      e.preventDefault();\r\n    });\r\n  });\r\n  \r\n  viewer.addEventListener('click', closeViewer);\r\n  window.addEventListener('scroll', debounce(loadThumbnails, 50));\r\n\r\n  document.addEventListener('keyup', (e) => {\r\n    if (e.keyCode === 27 && viewer.classList.contains('Gallery-viewer--open')) {\r\n      closeViewer();\r\n      e.preventDefault();\r\n    }\r\n  });\r\n  \r\n  function debounce(func, wait, immediate) {\r\n    var timeout;\r\n    return function() {\r\n      var context = this, args = arguments;\r\n      var later = function() {\r\n        timeout = null;\r\n        if (!immediate) func.apply(context, args);\r\n      };\r\n      var callNow = immediate && !timeout;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(later, wait);\r\n      if (callNow) func.apply(context, args);\r\n    };\r\n  }\r\n  \r\n  function preload(url, cb) {\r\n    const loader = new Image();\r\n    loader.onload = cb;\r\n    loader.src = url;\r\n  }\r\n  \r\n  function loadThumbnails() {\r\n    const imgs = Array.prototype.slice.call(document.querySelectorAll(`[data-loaded=\"${LOADED_PREVIEW}\"]`));\r\n    imgs.forEach(loadThumbnail);\r\n  }\r\n\r\n  function loadThumbnail(img) {\r\n    if (img.getBoundingClientRect().top < window.innerHeight + 500) {\r\n      const urlThumb = img.getAttribute('data-thumb');\r\n      preload(urlThumb, () => {\r\n        img.style.backgroundImage = `url(${urlThumb})`;\r\n        img.classList.remove('Gallery-image--preview');\r\n      });\r\n    }\r\n  }\r\n\r\n  function openViewer(img) {\r\n    clearTimeout(resetViewer);\r\n    const urlThumb = img.getAttribute('data-thumb');\r\n    const urlFull = img.getAttribute('data-full');\r\n\r\n    if (img.getAttribute('data-loaded') < LOADED_FULL) {\r\n      viewer.style.backgroundImage = `url(${urlThumb})`;\r\n\r\n      preload(urlFull, () => {\r\n        setTimeout(() => {\r\n          viewer.style.backgroundImage = `url(${urlFull})`;\r\n          img.setAttribute('data-loaded', LOADED_FULL);\r\n        }, 500);\r\n      });\r\n    } else {\r\n      viewer.style.backgroundImage = `url(${urlFull})`;\r\n    }\r\n\r\n    const pos = img.getBoundingClientRect();\r\n    viewer.style.width = pos.width + 'px';\r\n    viewer.style.height = pos.height + 'px';\r\n    viewer.style.top = pos.top + 'px';\r\n    viewer.style.left = pos.left + 'px';\r\n    viewer.clientHeight;\r\n    viewer.classList.add('Gallery-viewer--open');\r\n  }\r\n\r\n  function closeViewer() {\r\n    viewer.classList.add('Gallery-viewer--closing');\r\n    viewer.classList.remove('Gallery-viewer--open');\r\n  \r\n    resetViewer = setTimeout(() => {\r\n      viewer.classList.remove('Gallery-viewer--closing');\r\n      viewer.style.backgroundImage = '';\r\n      viewer.style.width = '';\r\n      viewer.style.height = '';\r\n      viewer.style.top = '';\r\n      viewer.style.left = '';\r\n    }, 500);\r\n  }\r\n})();\r\n"]}