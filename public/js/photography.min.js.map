{"version":3,"sources":["photography.js"],"names":["preload","url","cb","const","loader","Image","onload","src","loadThumbnails","Array","prototype","slice","call","document","querySelectorAll","forEach","img","getBoundingClientRect","top","window","innerHeight","urlThumb","getAttribute","style","backgroundImage","classList","remove","openViewer","clearTimeout","resetViewer","urlFull","hasAttribute","viewer","setTimeout","setAttribute","pos","width","height","left","clientHeight","add","closeViewer","querySelector","urlPreview","addEventListener","e","preventDefault","func","wait","immediate","timeout","context","this","args","arguments","callNow","apply","debounce","keyCode","contains"],"mappings":"CAAA,WA8CE,SAASA,EAAQC,EAAKC,GACpBC,IAAMC,EAAS,IAAIC,MACnBD,EAAOE,OAASJ,EAChBE,EAAOG,IAAMN,EAGf,SAASO,IACMC,MAAMC,UAAUC,MAAMC,KAAKC,SAASC,iBAAiB,4BAC7DC,QAAQ,SAAAC,GACX,GAAIA,EAAIC,wBAAwBC,IAAMC,OAAOC,YAAc,IAAK,CAC9DjB,IAAMkB,EAAWL,EAAIM,aAAa,cAClCtB,EAAQqB,EAAU,WAChBL,EAAIO,MAAMC,gBAAkB,OAAKH,EAAE,IACnCL,EAAIS,UAAUC,OAAO,+BAM7B,SAASC,EAAWX,GAClBY,aAAaC,GACb1B,IAAMkB,EAAWL,EAAIM,aAAa,cAC5BQ,EAAUd,EAAIM,aAAa,aAE5BN,EAAIe,aAAa,eAUpBC,EAAOT,MAAMC,gBAAkB,OAAKM,EAAE,KATtCE,EAAOT,MAAMC,gBAAkB,OAAKH,EAAE,IAEtCrB,EAAQ8B,EAAS,WACfG,WAAW,WACTD,EAAOT,MAAMC,gBAAkB,OAAKM,EAAE,IACtCd,EAAIkB,aAAa,cAAe,KAC/B,QAMP/B,IAAMgC,EAAMnB,EAAIC,wBAChBe,EAAOT,MAAMa,MAAQD,EAAIC,MAAQ,KACjCJ,EAAOT,MAAMc,OAASF,EAAIE,OAAS,KACnCL,EAAOT,MAAML,IAAMiB,EAAIjB,IAAM,KAC7Bc,EAAOT,MAAMe,KAAOH,EAAIG,KAAO,KAC/BN,EAAOO,aACPP,EAAOP,UAAUe,IAAI,wBAGvB,SAASC,IACPT,EAAOP,UAAUe,IAAI,2BACrBR,EAAOP,UAAUC,OAAO,wBAExBG,EAAcI,WAAW,WACvBD,EAAOP,UAAUC,OAAO,2BACxBM,EAAOT,MAAMC,gBAAkB,GAC/BQ,EAAOT,MAAMa,MAAQ,GACrBJ,EAAOT,MAAMc,OAAS,GACtBL,EAAOT,MAAML,IAAM,GACnBc,EAAOT,MAAMe,KAAO,IACnB,KAtGLnC,IAEI0B,EAFEG,EAASnB,SAAS6B,cAAc,mBACzBjC,MAAMC,UAAUC,MAAMC,KAAKC,SAASC,iBAAiB,mBAG7DC,QAAQ,SAAAC,GACXb,IAAMwC,EAAa3B,EAAIM,aAAa,gBAEpCN,EAAIS,UAAUe,IAAI,0BAClBxC,EAAQ2C,EAAY,WAClB3B,EAAIO,MAAMC,gBAAkB,OAAKmB,EAAE,MAGrC3B,EAAI4B,iBAAiB,QAAS,SAAAC,GAC5BlB,EAAWX,GACX6B,EAAEC,qBAINtC,IAEAwB,EAAOY,iBAAiB,QAASH,GACjCtB,OAAOyB,iBAAiB,SASxB,SAAkBG,EAAMC,EAAMC,GAC5B,IAAIC,EACJ,OAAO,WACL,IAAIC,EAAUC,KAAMC,EAAOC,UAKvBC,EAAUN,IAAcC,EAC5BtB,aAAasB,GACbA,EAAUjB,WANE,WACViB,EAAU,KACLD,GAAWF,EAAKS,MAAML,EAASE,IAIVL,GACxBO,GAASR,EAAKS,MAAML,EAASE,IApBHI,CAASjD,EAAgB,KAE3DK,SAAS+B,iBAAiB,QAAS,SAAAC,GACf,KAAdA,EAAEa,SAAkB1B,EAAOP,UAAUkC,SAAS,0BAChDlB,IACAI,EAAEC,oBA3BR","file":"photography.min.js","sourcesContent":["(() => {\r\n  const viewer = document.querySelector('.Gallery-viewer');\r\n  const imgs = Array.prototype.slice.call(document.querySelectorAll('[data-preview]'));\r\n  let resetViewer;\r\n  \r\n  imgs.forEach((img) => {\r\n    const urlPreview = img.getAttribute('data-preview');\r\n  \r\n    img.classList.add('Gallery-image--preview');\r\n    preload(urlPreview, () => {\r\n      img.style.backgroundImage = `url(${urlPreview})`;\r\n    });\r\n  \r\n    img.addEventListener('click', (e) => {\r\n      openViewer(img);\r\n      e.preventDefault();  \r\n    });\r\n  });\r\n  \r\n  loadThumbnails();\r\n  \r\n  viewer.addEventListener('click', closeViewer);\r\n  window.addEventListener('scroll', debounce(loadThumbnails, 50));\r\n\r\n  document.addEventListener('keyup', (e) => {\r\n    if (e.keyCode === 27 && viewer.classList.contains('Gallery-viewer--open')) {\r\n      closeViewer();\r\n      e.preventDefault();\r\n    }\r\n  });\r\n  \r\n  function debounce(func, wait, immediate) {\r\n    var timeout;\r\n    return function() {\r\n      var context = this, args = arguments;\r\n      var later = function() {\r\n        timeout = null;\r\n        if (!immediate) func.apply(context, args);\r\n      };\r\n      var callNow = immediate && !timeout;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(later, wait);\r\n      if (callNow) func.apply(context, args);\r\n    };\r\n  }\r\n  \r\n  function preload(url, cb) {\r\n    const loader = new Image();\r\n    loader.onload = cb;\r\n    loader.src = url;\r\n  }\r\n  \r\n  function loadThumbnails() {\r\n    const imgs = Array.prototype.slice.call(document.querySelectorAll('.Gallery-image--preview'));\r\n    imgs.forEach((img) => {\r\n      if (img.getBoundingClientRect().top < window.innerHeight + 500) {\r\n        const urlThumb = img.getAttribute('data-thumb');\r\n        preload(urlThumb, () => {\r\n          img.style.backgroundImage = `url(${urlThumb})`;\r\n          img.classList.remove('Gallery-image--preview');\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  function openViewer(img) {\r\n    clearTimeout(resetViewer);\r\n    const urlThumb = img.getAttribute('data-thumb');\r\n    const urlFull = img.getAttribute('data-full');\r\n\r\n    if (!img.hasAttribute('data-loaded')) {\r\n      viewer.style.backgroundImage = `url(${urlThumb})`;\r\n\r\n      preload(urlFull, () => {\r\n        setTimeout(() => {\r\n          viewer.style.backgroundImage = `url(${urlFull})`;\r\n          img.setAttribute('data-loaded', '');\r\n        }, 500);\r\n      });\r\n    } else {\r\n      viewer.style.backgroundImage = `url(${urlFull})`;\r\n    }\r\n\r\n    const pos = img.getBoundingClientRect();\r\n    viewer.style.width = pos.width + 'px';\r\n    viewer.style.height = pos.height + 'px';\r\n    viewer.style.top = pos.top + 'px';\r\n    viewer.style.left = pos.left + 'px';\r\n    viewer.clientHeight;\r\n    viewer.classList.add('Gallery-viewer--open');\r\n  }\r\n\r\n  function closeViewer() {\r\n    viewer.classList.add('Gallery-viewer--closing');\r\n    viewer.classList.remove('Gallery-viewer--open');\r\n  \r\n    resetViewer = setTimeout(() => {\r\n      viewer.classList.remove('Gallery-viewer--closing');\r\n      viewer.style.backgroundImage = '';\r\n      viewer.style.width = '';\r\n      viewer.style.height = '';\r\n      viewer.style.top = '';\r\n      viewer.style.left = '';\r\n    }, 500);\r\n  }\r\n})();\r\n"]}